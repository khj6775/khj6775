# cancer, wine, digits

from sklearn.datasets import load_breast_cancer, load_wine, load_digits
from sklearn.tree import DecisionTreeClassifier
from sklearn.ensemble import RandomForestClassifier, GradientBoostingClassifier
from xgboost import XGBClassifier
from sklearn.preprocessing import MinMaxScaler, StandardScaler

#1. 데이터

dataset1 = load_breast_cancer()
dataset2 = load_wine()
dataset3 = load_digits()

datasets = [dataset1, dataset2, dataset3]
name = ['cancer', 'wine', 'digits']

i=0
for dataset in datasets:
    x = dataset.data
    y = dataset.target

    random_state = 11

    from sklearn.model_selection import train_test_split
    x_train, x_test, y_train, y_test = train_test_split(
              x, y, train_size=0.8, random_state=random_state,
              stratify=y,
    )
    
    scaler = StandardScaler()
    x_train = scaler.fit_transform(x_train)
    x_test = scaler.transform(x_test)

    print("=============", name[i], "================")   # 클래스 이름만 나오게 한다.

    #2. 모델구성
    model1 = DecisionTreeClassifier(random_state=random_state)
    model2 = RandomForestClassifier(random_state=random_state)
    model3 = GradientBoostingClassifier(random_state=random_state)
    model4 = XGBClassifier(random_state=random_state)

    models = [model1, model2, model3, model4]

    print('random_state :', random_state)
    for model in models:
        model.fit(x_train, y_train)

        print("=============", model.__class__.__name__, "================")   # 클래스 이름만 나오게 한다.
        print('acc', model.score(x_test, y_test))
        print(model.feature_importances_)
    i=i+1


# ============= cancer ================
# random_state : 11
# ============= DecisionTreeClassifier ================
# acc 0.8859649122807017
# [0.         0.04480922 0.         0.         0.         0.
#  0.         0.         0.         0.         0.         0.00872033
#  0.         0.03081308 0.         0.         0.01852139 0.00626075
#  0.         0.         0.         0.03287696 0.01680719 0.08663851
#  0.0175301  0.         0.         0.72897293 0.         0.00804954]
# ============= RandomForestClassifier ================
# acc 0.9649122807017544
# [0.04048022 0.01846973 0.05683053 0.03336327 0.004316   0.01192265
#  0.02757928 0.13373918 0.00299085 0.00327213 0.01387897 0.00604258
#  0.00936217 0.03486802 0.00333589 0.00655976 0.00363187 0.00302756
#  0.00285208 0.00370324 0.12988667 0.0221789  0.11164428 0.10500457
#  0.00962513 0.0141396  0.02079885 0.15178119 0.00905722 0.00565763]
# ============= GradientBoostingClassifier ================
# acc 0.9473684210526315
# [2.13563714e-04 3.38747754e-02 8.61049211e-04 3.37422909e-04
#  7.58386843e-05 2.68313593e-04 3.28232459e-04 7.96197689e-02
#  9.00825732e-05 8.87837228e-05 9.80134060e-05 8.36699663e-04
#  7.19399947e-05 1.56472674e-02 1.22028262e-03 8.24986271e-07
#  3.33973904e-03 2.50476781e-07 1.87285672e-05 3.29586699e-03
#  2.65749732e-02 2.34352493e-02 2.50488999e-02 8.22519499e-02
#  8.43821358e-03 5.21301942e-04 1.27361106e-02 6.79294091e-01
#  2.06818882e-05 1.39108428e-03]
# ============= XGBClassifier ================
# acc 0.9473684210526315
# [0.01471312 0.02041623 0.         0.01096487 0.01129506 0.01483686
#  0.00698551 0.1361134  0.00097832 0.         0.00370241 0.00181596
#  0.         0.02129434 0.00373426 0.         0.         0.0047257
#  0.00388767 0.01027217 0.09183448 0.0154353  0.17450899 0.04995883
#  0.01189176 0.01655005 0.03798028 0.33265048 0.00345385 0.        ]
# ============= wine ================
# random_state : 11
# ============= DecisionTreeClassifier ================
# acc 0.9166666666666666
# [0.         0.01927311 0.         0.02086548 0.         0.
#  0.40339626 0.         0.         0.374048   0.         0.
#  0.18241716]
# ============= RandomForestClassifier ================
# acc 1.0
# [0.10312056 0.0291649  0.01413819 0.06464472 0.03020384 0.05090202
#  0.1664175  0.0142652  0.01992238 0.15719046 0.06752162 0.1129343
#  0.16957431]
# ============= GradientBoostingClassifier ================
# acc 0.9444444444444444
# [0.00502848 0.0319322  0.00249776 0.00149454 0.02028312 0.00248609
#  0.32242137 0.00122966 0.00131991 0.3112038  0.01653789 0.00547007
#  0.27809509]
# ============= XGBClassifier ================
# acc 0.9444444444444444
# [0.02492596 0.06526333 0.01924389 0.00909813 0.03709443 0.03542533
#  0.3045379  0.         0.00124088 0.25764513 0.01793043 0.03609847
#  0.19149615]
# ============= digits ================
# random_state : 11
# ============= DecisionTreeClassifier ================
# acc 0.8527777777777777
# [0.         0.01159771 0.00376491 0.0114255  0.00276891 0.0637003
#  0.00370235 0.00365261 0.         0.00333714 0.00723715 0.
#  0.00916757 0.01671612 0.         0.         0.         0.
#  0.01781231 0.01990422 0.05084771 0.09046634 0.         0.
#  0.         0.00658109 0.01905159 0.05668093 0.01133099 0.04319641
#  0.         0.         0.         0.05945136 0.03152915 0.00193309
#  0.07080631 0.02984564 0.00501348 0.         0.         0.00290275
#  0.12200491 0.05040893 0.01762563 0.0034884  0.00340223 0.
#  0.         0.         0.00528117 0.00735002 0.00411975 0.02632235
#  0.02247764 0.         0.         0.         0.00642918 0.00256632
#  0.06290755 0.00542609 0.0057662  0.        ]
# ============= RandomForestClassifier ================
# acc 0.9777777777777777
# [0.00000000e+00 3.23093170e-03 2.34955632e-02 9.72986047e-03
#  9.48197496e-03 1.71082917e-02 9.35755443e-03 1.14141121e-03
#  2.52003739e-05 8.48768089e-03 2.80280912e-02 7.49281573e-03
#  1.42242076e-02 2.91039558e-02 5.00686469e-03 7.57438913e-04
#  0.00000000e+00 1.02749818e-02 2.34836374e-02 2.62954966e-02
#  3.11178321e-02 4.77909462e-02 9.09711962e-03 3.61525555e-04
#  2.46271270e-05 1.43798806e-02 3.83851109e-02 2.58863162e-02
#  3.05224372e-02 2.10054195e-02 3.47171064e-02 1.27660571e-05
#  0.00000000e+00 2.90922034e-02 2.56321025e-02 1.45049621e-02
#  3.90836383e-02 1.81995639e-02 2.67983338e-02 0.00000000e+00
#  1.35410553e-05 1.17295421e-02 3.45549103e-02 4.32876911e-02
#  2.06394847e-02 1.99917834e-02 2.04247225e-02 5.93946023e-05
#  1.09521913e-04 2.52469174e-03 2.04438467e-02 2.26461270e-02
#  1.28328904e-02 2.55701329e-02 2.63403218e-02 1.29197139e-03
#  0.00000000e+00 1.79236068e-03 2.24686141e-02 1.02818511e-02
#  2.38587725e-02 2.60315757e-02 1.61883102e-02 3.58009170e-03]
# ============= GradientBoostingClassifier ================
# acc 0.9583333333333334
# [0.00000000e+00 4.16435529e-04 9.97589350e-03 3.89718270e-03
#  2.63542687e-03 6.27326677e-02 5.42818008e-03 2.65155387e-03
#  8.17682556e-05 1.32119670e-03 2.22581695e-02 1.25118574e-03
#  5.08237563e-03 1.13935895e-02 9.66582747e-04 6.91990457e-08
#  1.65644004e-04 2.09139647e-03 1.83329768e-02 3.96330704e-02
#  2.20952386e-02 8.86473338e-02 4.85145324e-03 0.00000000e+00
#  1.65097820e-04 2.72636428e-03 3.90709469e-02 1.88632248e-02
#  3.69503176e-02 2.65555962e-02 9.50667691e-03 0.00000000e+00
#  0.00000000e+00 6.38287980e-02 7.38036414e-03 7.16753042e-03
#  7.16190818e-02 1.04342072e-02 1.96672930e-02 0.00000000e+00
#  0.00000000e+00 8.00055483e-03 7.88482441e-02 6.05564597e-02
#  1.24363473e-02 1.74032757e-02 2.43295810e-02 8.58724159e-11
#  9.29472423e-05 1.05744117e-03 3.84376988e-03 1.92977629e-02
#  9.38763993e-03 1.66106141e-02 2.81154431e-02 2.48856737e-05
#  4.47323556e-05 3.03978436e-04 1.68579837e-02 9.87640465e-04
#  4.96939667e-02 4.70786219e-03 2.34625339e-02 4.09144573e-03]
# ============= XGBClassifier ================
# acc 0.9611111111111111
# [0.         0.04091441 0.00766761 0.01452408 0.00587242 0.03837743
#  0.00879886 0.01516457 0.         0.00855318 0.01113611 0.01083786
#  0.00885363 0.00855548 0.00571093 0.         0.         0.00622496
#  0.00643802 0.03156005 0.00926918 0.04653526 0.00190897 0.
#  0.         0.00823626 0.03254917 0.01048985 0.03143153 0.01801084
#  0.02061397 0.         0.         0.07726084 0.00423194 0.0064005
#  0.05487686 0.01331608 0.02944089 0.         0.         0.01114166
#  0.0392772  0.03721394 0.01113437 0.00914724 0.03137033 0.
#  0.         0.02513694 0.0040855  0.01105584 0.00715979 0.01950051
#  0.02749535 0.         0.         0.0017506  0.01380393 0.00842443
#  0.06499351 0.01967475 0.04414517 0.01972729]
